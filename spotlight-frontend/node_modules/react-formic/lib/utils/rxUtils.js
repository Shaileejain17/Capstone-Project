'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createStreamFromSuperagentRequest = createStreamFromSuperagentRequest;

var _rx = require('rx');

function createStreamFromSuperagentRequest(request) {
  var shouldAbortOnDispose = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];

  return _rx.Observable.create(function (observer) {
    var call = request.end(function (err, response) {
      if (err) {
        observer.onError(err);
      } else {
        observer.onNext(response);
      }
      observer.onCompleted();
    });

    return function () {
      if (shouldAbortOnDispose) {
        call.abort();
      }
    };
  });
}